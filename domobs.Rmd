---
title: "Dominance Scoring 2024"
subtitle: "draft" 
author:     | 
    | Quinlan Mann
    | 400420834
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  pdf_document:
    toc: no
  word_document:
    
    toc: no
  html_document:
    toc: no
    keep_md: yes
header-includes:
  - \usepackage{lineno}
  - \linenumbers
  - \usepackage{setspace}
  - \AtBeginEnvironment{tabular}{\singlespacing}
  - \AtBeginEnvironment{lltable}{\singlespacing}
  - \AtBeginEnvironment{tablenotes}{\doublespacing}
linestretch: 2
always_allow_html: true
---

```{r, setup, include=F}
knitr::opts_chunk$set(echo = FALSE, fig.width=6, fig.height=4, warning = F, message = F)
options(digits = 3)
```

## R Markdown

```{r libraries, include=F}
library(tidyverse)
library(reshape2)
library(EloRating)
library(RCurl)
```

## Creating Dataframes for each territory sampeled in 2011-12


```{r Datafrmes, echo=FALSE}
Doms<-getURL("https://raw.githubusercontent.com/QuinlanMann/Pukeko_Dom_Observations/main/Dom_Obs_Master.csv")
Doms<-read.csv(text=Doms)

Doms<-Doms%>%
  group_by(Group, Dominant, Subordinate)%>%
  summarize(count=length(Interaction))


for(i in as.list(unique(Doms$Group))) 
  {assign(paste("DS_",i, sep=""), filter(Doms, Group == i))}

list_of_objects <- mget(ls(.GlobalEnv, pattern = "DS_*"), envir = .GlobalEnv)
list_of_objects <- lapply(list_of_objects, 
                  function(x) x[,-c(1)])

list2env(list_of_objects, .GlobalEnv)
```
```{r}
# get names for row and columns
matrix_maker<-function(x){
  # construct 0 matrix of correct dimensions with row and column names
  myMat <- matrix(0, 
                  length(sort(unique(unlist(x[1:2])))), 
                  length(sort(unique(unlist(x[1:2])))), 
                  dimnames = list(sort(unique(unlist(x[1:2]))), 
                                  sort(unique(unlist(x[1:2])))))
  # fill in the matrix with matrix indexing on row and column names
  myMat[as.matrix(x[c("Dominant", "Subordinate")])] <- x[["count"]]
  return(myMat)
}
matrixces<-lapply(list_of_objects, matrix_maker)

matrixces$DS_EAST_CAMP_SE

```

```{r Matrix creation}
MyFunc <- function(x) {
  reshape2::dcast(data = x, formula = Dominant~Subordinate, value.var = "count")
}
list_of_objects <- lapply(X = list_of_objects, FUN = MyFunc)

col2name<-function(x){
  x<-x%>%
   remove_rownames%>%
    column_to_rownames(var = "Dominant")
}

list_of_objects<-lapply(list_of_objects, col2name)

list_of_objects<-lapply(list_of_objects, function(x) replace(x, is.na(x), 0))

list2env(list_of_objects, .GlobalEnv)
```

