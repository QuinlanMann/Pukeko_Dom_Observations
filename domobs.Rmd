---
title: "Dominance Scoring 2024"
subtitle: "draft" 
author:     | 
    | Quinlan Mann
    | 400420834
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  pdf_document:
    toc: no
  word_document:
    
    toc: no
  html_document:
    toc: no
    keep_md: yes
header-includes:
  - \usepackage{lineno}
  - \linenumbers
  - \usepackage{setspace}
  - \AtBeginEnvironment{tabular}{\singlespacing}
  - \AtBeginEnvironment{lltable}{\singlespacing}
  - \AtBeginEnvironment{tablenotes}{\doublespacing}
linestretch: 2
always_allow_html: true
---

```{r, setup, include=F}
knitr::opts_chunk$set(echo = FALSE, fig.width=6, fig.height=4, warning = F, message = F)
options(digits = 3)
```

## R Markdown

```{r libraries, include=F}
library(tidyverse)
library(reshape2)
library(EloRating)
library(RCurl)
```

## Creating Dataframes for each territory sampeled in 2011-12


```{r Datafrmes, echo=FALSE}
Doms<-getURL("https://raw.githubusercontent.com/QuinlanMann/Pukeko_Dom_Observations/main/Dom_Obs_Master.csv")
Doms<-read.csv(text=Doms)

Doms<-Doms%>%
  group_by(Group, Dominant, Subordinate)%>%
  summarize(count=length(Interaction))


for(i in as.list(unique(Doms$Group))) 
  {assign(paste("DS_",i, sep=""), filter(Doms, Group == i))}

list_of_objects <- mget(ls(.GlobalEnv, pattern = "DS_*"), envir = .GlobalEnv)
list_of_objects <- lapply(list_of_objects, 
                  function(x) x[,-c(1)])

list2env(list_of_objects, .GlobalEnv)
```

```{r Matrix creation}
MyFunc <- function(x) {
  reshape2::dcast(data = x, formula = Dominant~Subordinate, value.var = "count")
}
list_of_objects <- lapply(X = list_of_objects, FUN = MyFunc)

list2env(list_of_objects, .GlobalEnv)
```

